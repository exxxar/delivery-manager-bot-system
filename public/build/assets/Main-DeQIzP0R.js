import{_ as g,c as b,o as a,w as p,b as e,f as l,g as c,n as h,e as k,t as i,q as w,D as y,E as x,u as d,F as _,i as S,v as C,G as v,a as f,C as $,r as T,Z as L,H as j}from"./app-B2ZjzZbS.js";const M={name:"GlobalAlert",setup(){return{alertStore:y()}},computed:{alertClass(){switch(this.alertStore.type){case"success":return"alert-success";case"error":return"alert-error";default:return"alert-info"}}}},A={class:"wrapper-alert"};function U(o,s,t,r,n,m){return a(),b(w,{name:"fade"},{default:p(()=>[e("div",A,[r.alertStore.visible?(a(),l("div",{key:0,class:h(["global-alert",m.alertClass])},[k(i(r.alertStore.message)+" ",1),e("button",{class:"close-btn",onClick:s[0]||(s[0]=(...u)=>r.alertStore.hide&&r.alertStore.hide(...u))},"×")],2)):c("",!0)])]),_:1})}const B=g(M,[["render",U],["__scopeId","data-v-81bbd0b4"]]),N={class:"modal-dialog"},P={class:"modal-content"},V={class:"modal-header"},z={class:"modal-body"},O=["innerHTML"],W={class:"modal-footer"},D={},E=Object.assign(D,{__name:"GlobalConfirmModal",setup(o){const s=x();return(t,r)=>d(s).show?(a(),l("div",{key:0,class:h(["modal fade",{show:d(s).show}]),tabindex:"-1",style:{display:"block"}},[e("div",N,[e("div",P,[e("div",V,[r[3]||(r[3]=e("h5",{class:"modal-title"},"Подтверждение",-1)),e("button",{type:"button",class:"btn-close",onClick:r[0]||(r[0]=n=>d(s).close())})]),e("div",z,[e("p",{innerHTML:d(s).message},null,8,O)]),e("div",W,[e("button",{class:"btn btn-success",onClick:r[1]||(r[1]=n=>d(s).confirm())},"Подтвердить"),e("button",{class:"btn btn-danger",onClick:r[2]||(r[2]=n=>d(s).reject())},"Отклонить")])])])],2)):c("",!0)}}),G={name:"UserProfileCard",data(){return{userStore:v(),minimize:!0}},props:{user:{type:Object,required:!0}},mounted(){console.log("user in usercard",this.user)},methods:{async changeAdminWorkStatus(o){await this.userStore.updateWorkStatus(o.id,o.is_work)},roleLabel(o){return{0:"Пользователь",1:"Агент",2:"Поставщик",3:"Администратор",4:"Суперадмин"}[o]||"Неизвестно"}}},H={class:"card border-light border-2"},q={class:"card-body d-flex justify-content-center flex-column align-items-center"},F={class:"mb-1 fst-italic small text-primary fw-bold"},I={class:"text-muted mb-0"},J={key:0,class:"mb-1"},R={class:"mb-1"},Z={class:"form-check form-switch"},K=["id"],Q=["for"];function X(o,s,t,r,n,m){return a(),l("div",H,[e("div",q,[e("h5",{onClick:s[0]||(s[0]=u=>n.minimize=!n.minimize),class:"card-title mb-0 text-decoration-underline link-underline-primary"},i(t.user.name),1),e("p",F,i(m.roleLabel(t.user.role)),1),n.minimize?c("",!0):(a(),l(_,{key:0},[e("p",I,i(t.user.fio_from_telegram||"—"),1),t.user.telegram_chat_id?(a(),l("p",J,i(t.user.telegram_chat_id),1)):c("",!0),t.user.role>=3?(a(),l(_,{key:1},[e("p",R," Админский "+i(t.user.percent)+" % ",1),e("div",Z,[S(e("input",{onChange:s[1]||(s[1]=u=>m.changeAdminWorkStatus(t.user)),class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=u=>t.user.is_work=u),id:`is-work-${t.user.id}`},null,40,K),[[C,t.user.is_work]]),e("label",{class:"form-check-label",for:`is-work-${t.user.id}`},i(t.user.is_work?"за работай":"не работаю"),9,Q)])],64)):c("",!0)],64))])])}const Y=g(G,[["render",X]]),ee={class:"text-body-secondary",style:{padding:"0px 0px 90px 0px"}},te={class:"container d-flex justify-content-center flex-column align-items-center"},se={class:"d-flex justify-content-center my-3"},oe={class:"offcanvas offcanvas-start custom-offcanvas",style:{width:"70%","border-radius":"0px 10px 10px 0px"},tabindex:"-1",id:"sidebar-menu","aria-labelledby":"offcanvasExampleLabel"},re={class:"offcanvas-body"},ae={class:"list-group list-group-flush my-3"},ne={class:"p-2 list-group-item"},le={data(){return{userStore:v(),currentTheme:"",themes:[]}},watch:{},created(){this.userStore.fetchSelf()},computed:{tg(){return window.Telegram.WebApp},self(){return window.botUser||null}},mounted(){this.tg.expand(),this.tg.BackButton.hide()},methods:{goTo(o){this.$router.push({name:o})},scrollTop(){window.scrollTo(0,80)},openLink(o){this.tg.openLink(o,{try_instant_view:!0})},closeShop(){this.tg.close()}}},ie=Object.assign(le,{__name:"Layout",setup(o){return(s,t)=>(a(),l(_,null,[f(d(L),null,{default:p(()=>[...t[2]||(t[2]=[e("title",null,"Автоматический учет доставки",-1),e("meta",{name:"description",content:"CashMan - система твоего бизнеса внутри"},null,-1)])]),_:1}),t[5]||(t[5]=$('<header class="fixed-top-menu" data-bs-theme="dark"><div class="navbar shadow shadow-sm"><div class="container flex-row-reverse p-2"><span data-bs-toggle="modal" data-bs-target="#bot-info-modal" class="text-primary fw-bold cursor-pointer">Система управления доставками</span><button class="btn btn-link rounded-0 border-0 p-1" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar-menu" aria-controls="sidebar-menu"><i class="fa-solid fa-bars"></i></button></div></div></header>',1)),f(B),f(E),T(s.$slots,"default"),e("footer",ee,[e("div",te,[e("p",se,[e("a",{href:"javascript:void(0)",onClick:t[0]||(t[0]=(...r)=>s.scrollTop&&s.scrollTop(...r))},[...t[3]||(t[3]=[e("i",{class:"fa-solid fa-arrow-up mr-2"},null,-1),k("Вернуться наверх",-1)])])])])]),e("div",oe,[t[4]||(t[4]=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title",id:"offcanvasExampleLabel"},"Меню"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1)),e("div",re,[s.userStore.self?(a(),b(Y,{key:0,user:s.userStore.self},null,8,["user"])):c("",!0),e("ul",ae,[e("li",ne,[e("a",{"data-bs-dismiss":"offcanvas",class:h([{"fw-bold":s.$route.name==="MenuPage"},"text-decoration-none fw-normal"]),onClick:t[1]||(t[1]=r=>s.goTo("MenuPage")),href:"javascript:void(0)"}," Главное меню",2)])])])])],64))}}),de={key:1,class:"container py-3"},ce={data(){return{userStore:v()}},created(){this.userStore.fetchSelf()},computed:{tg(){return window.Telegram.WebApp},tgUser(){const o=new URLSearchParams(this.tg.initData);return JSON.parse(o.get("user"))}},mounted(){},methods:{open(o){this.tg.openLink(o)},goTo(o){this.$router.push({name:o})}}},me=Object.assign(ce,{__name:"Main",setup(o){return(s,t)=>{var n;const r=j("router-view");return(n=s.userStore.self)!=null&&n.blocked_at?(a(),l("div",de,[...t[0]||(t[0]=[e("p",{class:"alert alert-light text-center"}," Доступ ограничен ",-1)])])):(a(),b(ie,{key:0},{default:p(()=>[f(r)]),_:1}))}}});export{me as default};
