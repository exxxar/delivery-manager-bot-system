import{c as l,o as r,b as e,t as h,i as y,w as u,v as b,h as _,L as k,f as D,a as $,e as p,F as f,r as I,d as S,k as C,J as E,E as N,u as B,H as O}from"./app-CY6VkL7C.js";import{_ as T}from"./AgentList-ByNdI62V.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as j}from"./Pagination-CZTEa3Bi.js";import{m}from"./makeAxiosFactory-9ZzmHoQd.js";import{_ as F}from"./SupplierList-B7LP_Dcv.js";import{a as q}from"./ProductList-HR2oynkB.js";import{u as M}from"./users-B5yefxdF.js";const L={name:"CustomerCard",props:{customer:{type:Object,required:!0}}},A={class:"container-fluid p-3"},G={class:"card shadow-sm"},z={class:"card-header bg-primary text-white"},J={class:"mb-0"},R={class:"card-body"},H={class:"list-group list-group-flush"},K={class:"list-group-item"},Q={class:"list-group-item"},W={class:"list-group-item"},X={class:"list-group-item"},Y={class:"card-footer text-end"};function Z(o,s,t,i,a,n){return r(),l("div",A,[e("div",G,[e("div",z,[e("h5",J,h(t.customer.name),1)]),e("div",R,[e("ul",H,[e("li",K,[s[2]||(s[2]=e("strong",null,"Компания:",-1)),y(" "+h(t.customer.company_name),1)]),e("li",Q,[s[3]||(s[3]=e("strong",null,"Адрес:",-1)),y(" "+h(t.customer.address),1)]),e("li",W,[s[4]||(s[4]=e("strong",null,"Телефон:",-1)),y(" "+h(t.customer.phone),1)]),e("li",X,[s[5]||(s[5]=e("strong",null,"Email:",-1)),y(" "+h(t.customer.email),1)])])]),e("div",Y,[e("button",{class:"btn btn-outline-secondary me-2",onClick:s[0]||(s[0]=d=>o.$emit("close"))},"Закрыть"),e("button",{class:"btn btn-primary",onClick:s[1]||(s[1]=d=>o.$emit("edit",t.customer))},"Редактировать")])])])}const x=U(L,[["render",Z]]),tt={name:"CustomerForm",props:{initialData:{type:Object,default:null}},data(){return{form:{name:"",company_name:"",address:"",phone:"",email:""},isEdit:!1}},created(){this.initialData&&(this.form={...this.initialData},this.isEdit=!0)},methods:{async submitForm(){try{this.isEdit?(await k.put(`/api/customers/${this.form.id}`,this.form),alert("Клиент обновлён!")):(await k.post("/api/customers",this.form),alert("Клиент добавлен!")),this.$emit("saved")}catch(o){console.error("Ошибка сохранения клиента:",o)}}}},et={class:"container-fluid p-3"},st={class:"form-floating mb-3"},ot={class:"form-floating mb-3"},it={class:"form-floating mb-3"},nt={class:"form-floating mb-3"},at={class:"form-floating mb-3"},rt={type:"submit",class:"btn btn-primary w-100"};function lt(o,s,t,i,a,n){return r(),l("div",et,[e("form",{onSubmit:s[5]||(s[5]=_((...d)=>n.submitForm&&n.submitForm(...d),["prevent"]))},[e("div",st,[u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>a.form.name=d),type:"text",class:"form-control",id:"name",placeholder:"Имя",required:""},null,512),[[b,a.form.name]]),s[6]||(s[6]=e("label",{for:"name"},"Имя",-1))]),e("div",ot,[u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>a.form.company_name=d),type:"text",class:"form-control",id:"company_name",placeholder:"Компания",required:""},null,512),[[b,a.form.company_name]]),s[7]||(s[7]=e("label",{for:"company_name"},"Компания",-1))]),e("div",it,[u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>a.form.address=d),type:"text",class:"form-control",id:"address",placeholder:"Адрес",required:""},null,512),[[b,a.form.address]]),s[8]||(s[8]=e("label",{for:"address"},"Адрес",-1))]),e("div",nt,[u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=d=>a.form.phone=d),type:"tel",class:"form-control",id:"phone",placeholder:"Телефон",required:""},null,512),[[b,a.form.phone]]),s[9]||(s[9]=e("label",{for:"phone"},"Телефон",-1))]),e("div",at,[u(e("input",{"onUpdate:modelValue":s[4]||(s[4]=d=>a.form.email=d),type:"email",class:"form-control",id:"email",placeholder:"Email",required:""},null,512),[[b,a.form.email]]),s[10]||(s[10]=e("label",{for:"email"},"Email",-1))]),e("button",rt,h(a.isEdit?"Сохранить изменения":"Добавить клиента"),1)],32)])}const dt=U(tt,[["render",lt]]),v="/bot-api/customers",mt=D("customers",{state:()=>({items:[],loading:!1,error:null}),getters:{byId:o=>s=>o.items.find(t=>t.id===s)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{const{data:o}=await m(`${v}`,"GET");this.items=o}catch(o){this.error=(o==null?void 0:o.message)||"Failed to load customers"}finally{this.loading=!1}},async fetchAllByPage(o=1){const{data:s}=await m(`${v}?page=${o}`,"GET");this.items=s.data,this.pagination=s},async fetchByUrl(o){const{data:s}=await m(o,"GET");this.items=s.data,this.pagination=s},async create(o){const{data:s}=await m(v,"POST",o);return this.items.push(s),s},async update(o,s){const{data:t}=await m(v,"PUT",s),i=this.items.findIndex(a=>a.id===o);return i!==-1&&(this.items[i]=t),t},async remove(o){await m(`${v}/${o}`,"DELETE"),this.items=this.items.filter(s=>s.id!==o)}}}),ut={class:"form-floating mb-3"},pt={class:"list-group"},ct=["onClick"],ft={class:"fw-bold"},ht={class:"text-muted"},bt={class:"dropdown"},yt={class:"dropdown-menu dropdown-menu-end"},gt={key:0},_t=["onClick"],vt=["onClick"],$t=["onClick"],wt=["onClick"],Ct={key:0,class:"alert alert-info mt-3"},kt={class:"modal fade",id:"editCustomerModal",tabindex:"-1"},St={class:"modal-dialog modal-lg"},Et={class:"modal-content"},Dt={class:"modal-body"},Tt={class:"modal fade",id:"deleteCustomerModal",tabindex:"-1"},Ut={class:"modal-dialog"},Ft={class:"modal-content"},qt={class:"modal-body"},Vt={class:"modal-footer"},Pt={class:"modal fade",id:"viewCustomerModal",tabindex:"-1"},It={class:"modal-dialog"},Nt={class:"modal-content"},Bt={class:"modal-body"},Ot={name:"CustomerList",props:["forSelect"],data(){return{search:null,customerStore:mt(),selectedCustomer:null}},computed:{filteredCustomers(){if(!this.search)return this.customerStore.items||[];const o=this.search.toLowerCase();return this.customerStore.items.filter(s=>Object.values(s).some(t=>t?String(t).toLowerCase().includes(o):!1))}},created(){this.fetchData()},methods:{selectCustomer(o){this.forSelect&&this.$emit("select",o)},async fetchData(o=1){await this.customerStore.fetchAllByPage(o)},async fetchDataByUrl(o){await this.customerStore.fetchByUrl(o)},openEdit(o){this.selectedCustomer=o,new bootstrap.Modal(document.getElementById("editCustomerModal")).show()},confirmDelete(o){this.selectedCustomer=o,new bootstrap.Modal(document.getElementById("deleteCustomerModal")).show()},async deleteCustomer(){try{await k.delete(`/api/customers/${this.selectedCustomer.id}`),this.customers=this.customers.filter(o=>o.id!==this.selectedCustomer.id),bootstrap.Modal.getInstance(document.getElementById("deleteCustomerModal")).hide()}catch(o){console.error("Ошибка удаления клиента:",o)}},openView(o){this.selectedCustomer=o,new bootstrap.Modal(document.getElementById("viewCustomerModal")).show()}}},V=Object.assign(Ot,{setup(o){return(s,t)=>{var i;return r(),l(f,null,[e("div",ut,[u(e("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=a=>s.search=a),class:"form-control",id:"searchInput",placeholder:"Поиск..."},null,512),[[b,s.search]]),t[2]||(t[2]=e("label",{for:"searchInput"},"Поиск",-1))]),e("ul",pt,[(r(!0),l(f,null,I(s.filteredCustomers,a=>(r(),l("li",{onClick:n=>s.selectCustomer(a),key:a.id,class:"list-group-item d-flex justify-content-between align-items-center"},[e("div",null,[e("div",ft,h(a.name),1),e("small",ht,h(a.company_name),1)]),e("div",bt,[t[3]||(t[3]=e("button",{class:"btn btn-sm",type:"button","data-bs-toggle":"dropdown"},[e("i",{class:"fas fa-bars"})],-1)),e("ul",yt,[o.forSelect?(r(),l("li",gt,[e("a",{class:"dropdown-item",href:"#",onClick:_(n=>s.selectCustomer(a),["prevent"])},"Выбрать клиента",8,_t)])):(r(),l(f,{key:1},[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:_(n=>s.openEdit(a),["prevent"])},"Редактировать",8,vt)]),e("li",null,[e("a",{class:"dropdown-item text-danger",href:"#",onClick:_(n=>s.confirmDelete(a),["prevent"])},"Удалить",8,$t)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:_(n=>s.openView(a),["prevent"])},"Просмотреть",8,wt)])],64))])])],8,ct))),128))]),$(j,{pagination:s.customerStore.pagination,onPageChanged:s.fetchDataByUrl},null,8,["pagination","onPageChanged"]),s.customerStore.items.length===0?(r(),l("div",Ct," Клиентов пока нет. ")):p("",!0),e("div",kt,[e("div",St,[e("div",Et,[t[4]||(t[4]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Редактирование клиента"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Dt,[s.selectedCustomer?(r(),S(dt,{key:0,initialData:s.selectedCustomer,onSaved:s.fetchCustomers},null,8,["initialData","onSaved"])):p("",!0)])])])]),e("div",Tt,[e("div",Ut,[e("div",Ft,[t[8]||(t[8]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title text-danger"},"Удаление клиента"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",qt,[t[5]||(t[5]=y(" Вы уверены, что хотите удалить ",-1)),e("strong",null,h((i=s.selectedCustomer)==null?void 0:i.name),1),t[6]||(t[6]=y("? ",-1))]),e("div",Vt,[t[7]||(t[7]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Отмена",-1)),e("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=(...a)=>s.deleteCustomer&&s.deleteCustomer(...a))},"Удалить")])])])]),e("div",Pt,[e("div",It,[e("div",Nt,[t[9]||(t[9]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Карточка клиента"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Bt,[s.selectedCustomer?(r(),S(x,{key:0,customer:s.selectedCustomer,onEdit:s.openEdit},null,8,["customer","onEdit"])):p("",!0)])])])])],64)}}}),c="/bot-api/sales",jt=D("sales",{state:()=>({items:[],loading:!1,filters:null,error:null,sort:{field:"id",direction:"desc"}}),getters:{byId:o=>s=>o.items.find(t=>t.id===s)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{const{data:o}=await m(`${c}`,"GET");this.items=o}catch(o){this.error=(o==null?void 0:o.message)||"Failed to load sales"}finally{this.loading=!1}},async selfSalesFiltered(o=1,s=30){const t=new URLSearchParams;Object.entries(this.filters).forEach(([a,n])=>{n!=null&&n!==""&&t.append(a,String(n))}),t.append("sort_field",this.sort.field),t.append("sort_direction",this.sort.direction),t.append("page",String(o)),t.append("size",String(s));const{data:i}=await m(`${c}/self-sales?${t.toString()}`,"GET");return this.items=i.data,this.pagination=i,!0},async fetchFiltered(o=1,s=30){const t=new URLSearchParams;Object.entries(this.filters).forEach(([a,n])=>{n!=null&&n!==""&&t.append(a,String(n))}),t.append("sort_field",this.sort.field),t.append("sort_direction",this.sort.direction),t.append("page",String(o)),t.append("size",String(s));const{data:i}=await m(`${c}?${t.toString()}`,"GET");return this.items=i.data,this.pagination=i,!0},setFilters(o){this.filters=o},setSort(o,s){this.sort={field:o,direction:s}},async fetchAllByPage(o=1){const{data:s}=await m(`${c}?page=${o}`,"GET");this.items=s.data,this.pagination=s},async fetchByUrl(o){const{data:s}=await m(o,"GET");this.items=s.data,this.pagination=s},async sendPaymentDocumentToTg(o){try{const{data:s}=await m(`${c}/payment-document/${o}`,"GET");return!0}catch(s){throw this.error=(s==null?void 0:s.message)||"Failed to load sale",s}},async fetchOne(o){try{const{data:s}=await m(`${c}/${o}`,"GET");return s}catch(s){throw this.error=(s==null?void 0:s.message)||"Failed to load sale",s}},async create(o,s){const t=new FormData;Object.keys(o).forEach(a=>{const n=o[a]||"";typeof n=="object"?t.append(a,JSON.stringify(n)):t.append(a,n)}),s&&t.append("file",s);const{data:i}=await m(`${c}`,"POST",t,{headers:{"Content-Type":"multipart/form-data"}});return this.items.push(i),i},async update(o,s,t){const i=new FormData;Object.keys(s).forEach(d=>{const w=s[d]||"";typeof w=="object"?i.append(d,JSON.stringify(w)):i.append(d,w)}),t&&i.append("file",t);const{data:a}=await m(`${c}/${o}`,"PUT",i,{headers:{"Content-Type":"multipart/form-data"}}),n=this.items.findIndex(d=>d.id===o);return n!==-1&&(this.items[n]=a),a},async confirmPayment(o){var s;try{const t=new FormData;t.append("id",o.id||null),t.append("payment_type",o.payment_type||0),t.append("receipt_is_lost",o.receipt_is_lost||!1),o.file&&t.append("file",o.file);const{data:i}=await m(`${c}/confirm-payment`,"POST",t,{headers:{"Content-Type":"multipart/form-data"}});return await this.fetchAllByPage(((s=this.pagination)==null?void 0:s.current_page)||1),i}catch(t){throw t}},async confirmDeal(o){var s;try{const{data:t}=await m(`${c}/${o.id}`,"PUT",{...o,status:"completed"});return await this.fetchAllByPage(((s=this.pagination)==null?void 0:s.current_page)||1),t}catch(t){throw console.error("Ошибка подтверждения сделки:",t),t}},async deleteSale(o){try{return await m(`${c}/${o}`,"DELETE"),this.items=this.items.filter(s=>s.id!==o),!0}catch(s){throw console.error("Ошибка удаления продажи:",s),s}},async cancelDeal(o){var s;try{const{data:t}=await m(`${c}/${o.id}`,"PUT",{...o,status:"rejected"});return await this.fetchAllByPage(((s=this.pagination)==null?void 0:s.current_page)||1),t}catch(t){throw console.error("Ошибка отмены сделки:",t),t}}}});let g={spent_time_counter:0};function Mt(){const o=parseInt(localStorage.getItem("delivery_click_counter")||"0");return o>0?(P(o),!0):!1}function P(o){g.spent_time_counter=parseInt(o)!=null?Math.min(parseInt(o),10):10;let s=setInterval(()=>{g.spent_time_counter>0?g.spent_time_counter--:(clearInterval(s),g.spent_time_counter=null),localStorage.setItem("delivery_click_counter",g.spent_time_counter),window.dispatchEvent(new CustomEvent("trigger-spent-timer",{detail:g.spent_time_counter}))},1e3)}const Lt={key:0,class:"form-check form-switch mb-2"},At={class:"form-check-label",for:"need_automatic_naming"},Gt={key:0,class:"fw-bold text-primary"},zt={key:1,class:"fw-bold text-primary"},Jt={class:"form-floating mb-2"},Rt={class:"form-floating mb-2"},Ht={class:"input-group mb-2"},Kt={class:"form-floating flex-grow-1"},Qt=["value"],Wt={class:"input-group mb-2"},Xt={class:"form-floating flex-grow-1"},Yt=["value"],Zt=["disabled"],xt={class:"form-floating mb-2"},te={class:"form-floating mb-2"},ee={class:"form-floating mb-2"},se={class:"form-floating mb-2"},oe=["required"],ie={class:"form-check form-switch mb-2"},ne={key:4,class:"form-floating mb-2"},ae={class:"form-check form-switch mb-2"},re={class:"form-floating mb-2"},le=["min"],de={class:"input-group mb-2"},me={class:"form-floating flex-grow-1"},ue=["value"],pe=["disabled"],ce={key:0},fe={key:1},he={name:"SaleForm",components:{AgentList:T,CustomerList:V,SupplierListGroup:F,ProductList:q},props:{initialData:{type:Object,default:null}},watch:{"form.quantity":function(o,s){this.form.total_price=(this.product.price*this.form.quantity).toFixed(2)}},computed:{user(){return this.userStore.self||null},productName(){var o;return((o=this.product)==null?void 0:o.name)||""}},data(){return{tab:"main",spent_time:0,alertStore:O(),salesStore:jt(),userStore:M(),can_add_past_assignments:!1,file:null,product_filters:{supplier_id:null},form:{title:"",description:"",status:"pending",due_date:"",sale_date:"",quantity:0,total_price:0,agent_id:null,customer_id:null,supplier_id:null,product_id:null,payment_type:"0",payment_document_name:null,need_automatic_naming:!0,receipt_is_lost:!1},agentName:"",customerName:"",supplierName:"",product:null,isEdit:!1}},created(){var o,s,t;this.initialData&&(this.form={...this.initialData},this.isEdit=!0,this.agentName=((o=this.initialData.agent)==null?void 0:o.name)||"",this.customerName=((s=this.initialData.customer)==null?void 0:s.name)||"",this.supplierName=((t=this.initialData.supplier)==null?void 0:t.name)||"",this.product=this.initialData.product||null)},mounted(){Mt(),window.addEventListener("trigger-spent-timer",o=>{this.spent_time=o.detail})},methods:{onFileChange(o){this.file=o.target.files[0]},selectAgent(o){this.form.agent_id=o.id,this.agentName=o.name,this.tab="main"},selectCustomer(o){this.form.customer_id=o.id,this.customerName=o.name,this.tab="main"},selectSupplier(o){const s=this.form.supplier_id;this.form.supplier_id=null,this.supplierName=null,this.product_filters.supplier_id=null,s!==o.id&&(this.form.product_id=null,this.product=null),this.$nextTick(()=>{this.form.supplier_id=o.id,this.supplierName=o.name,this.tab="main",this.product_filters.supplier_id=o.id})},selectProduct(o){this.form.product_id=o.id,this.product=o,this.tab="main",this.form.quantity=1,this.form.total_price=o.price||0},async submitForm(){this.alertStore.show("Началось добавление заявки"),P(10),this.isEdit?await this.salesStore.update(this.form.id,this.form,this.file):await this.salesStore.create(this.form,this.file),this.$emit("saved")}}},ke=Object.assign(he,{setup(o){const s=new Date().toISOString().split("T")[0];return(t,i)=>{var a;return r(),l("form",{onSubmit:i[18]||(i[18]=_((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[t.tab==="main"?(r(),l(f,{key:0},[t.isEdit?p("",!0):(r(),l("div",Lt,[u(e("input",{"onUpdate:modelValue":i[0]||(i[0]=n=>t.form.need_automatic_naming=n),class:"form-check-input",type:"checkbox",role:"switch",id:"need_automatic_naming"},null,512),[[C,t.form.need_automatic_naming]]),e("label",At,[i[19]||(i[19]=y("Автоматическое название и описание ",-1)),t.form.need_automatic_naming?(r(),l("span",Gt,"включено")):(r(),l("span",zt,"выключено"))])])),t.form.need_automatic_naming?p("",!0):(r(),l(f,{key:1},[e("div",Jt,[u(e("input",{"onUpdate:modelValue":i[1]||(i[1]=n=>t.form.title=n),type:"text",class:"form-control",id:"title",placeholder:"Название",required:""},null,512),[[b,t.form.title]]),i[20]||(i[20]=e("label",{for:"title"},"Название задания",-1))]),e("div",Rt,[u(e("textarea",{"onUpdate:modelValue":i[2]||(i[2]=n=>t.form.description=n),class:"form-control",id:"description",placeholder:"Описание",style:{height:"120px"},required:""},null,512),[[b,t.form.description]]),i[21]||(i[21]=e("label",{for:"description"},"Описание задания",-1))])],64)),e("div",Ht,[e("div",Kt,[e("input",{required:"",type:"text",class:"form-control",id:"supplier",value:t.supplierName,placeholder:"Поставщик",readonly:""},null,8,Qt),i[22]||(i[22]=e("label",{for:"supplier"},"Поставщик",-1))]),e("button",{type:"button",class:"btn btn-outline-light text-primary find-btn",onClick:i[3]||(i[3]=n=>t.tab="supplier")},"Выбрать ")]),e("div",Wt,[e("div",Xt,[e("input",{type:"text",required:"",class:"form-control",id:"product",value:t.productName,placeholder:"Продукт",readonly:""},null,8,Yt),i[23]||(i[23]=e("label",{for:"product"},"Продукт",-1))]),e("button",{type:"button",disabled:t.form.supplier_id==null,class:"btn btn-outline-light text-primary find-btn",onClick:i[4]||(i[4]=n=>t.tab="product")},"Выбрать",8,Zt)]),t.form.supplier_id&&t.form.product_id?(r(),l(f,{key:2},[e("div",xt,[u(e("input",{required:"","onUpdate:modelValue":i[5]||(i[5]=n=>t.form.quantity=n),type:"number",class:"form-control",id:"quantity",placeholder:"Количество"},null,512),[[b,t.form.quantity]]),i[24]||(i[24]=e("label",{for:"quantity"},"Количество",-1))]),e("div",te,[u(e("input",{"onUpdate:modelValue":i[6]||(i[6]=n=>t.form.total_price=n),required:"",type:"number",step:"0.01",class:"form-control",id:"total_price",placeholder:"Сумма"},null,512),[[b,t.form.total_price]]),i[25]||(i[25]=e("label",{for:"total_price"},"Сумма сделки",-1))])],64)):p("",!0),e("div",ee,[u(e("select",{class:"form-select","onUpdate:modelValue":i[7]||(i[7]=n=>t.form.payment_type=n),id:"payment-type","aria-label":"Floating label select example"},[...i[26]||(i[26]=[e("option",{value:"0"},"Наличный расчет",-1),e("option",{value:"1"},"Безналичный расчет",-1)])],512),[[E,t.form.payment_type]]),i[27]||(i[27]=e("label",{for:"payment-type"},"Тип оплаты",-1))]),t.form.payment_type==="1"?(r(),l(f,{key:3},[i[30]||(i[30]=e("h6",null,"Фотография чека",-1)),e("div",se,[e("input",{type:"file",class:"form-control",onChange:i[8]||(i[8]=(...n)=>t.onFileChange&&t.onFileChange(...n)),accept:".jpg,.png,.pdf",required:!t.form.receipt_is_lost},null,40,oe),i[28]||(i[28]=e("label",{for:"payment-type"},"Прикрепить",-1))]),e("div",ie,[u(e("input",{"onUpdate:modelValue":i[9]||(i[9]=n=>t.form.receipt_is_lost=n),class:"form-check-input",type:"checkbox",role:"switch",id:"need_automatic_naming"},null,512),[[C,t.form.receipt_is_lost]]),i[29]||(i[29]=e("label",{class:"form-check-label",for:"need_automatic_naming"},"Чек был утрачен ",-1))])],64)):p("",!0),t.isEdit?(r(),l("div",ne,[u(e("select",{"onUpdate:modelValue":i[10]||(i[10]=n=>t.form.status=n),class:"form-select",id:"status",required:""},[...i[31]||(i[31]=[N('<option value="pending">Ожидает</option><option value="assigned">Назначено</option><option value="delivered">Доставляется</option><option value="completed">Завершено</option><option value="rejected">Отклонено</option>',5)])],512),[[E,t.form.status]]),i[32]||(i[32]=e("label",{for:"status"},"Статус",-1))])):p("",!0),e("div",ae,[u(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":i[11]||(i[11]=n=>t.can_add_past_assignments=n),id:"can-add-past-tasks"},null,512),[[C,t.can_add_past_assignments]]),i[33]||(i[33]=e("label",{class:"form-check-label",for:"can-add-past-tasks"}," Разрешить вносить за прошедшие дни ",-1))]),e("div",re,[u(e("input",{"onUpdate:modelValue":i[12]||(i[12]=n=>t.form.due_date=n),required:"",min:t.can_add_past_assignments?null:B(s),type:"date",class:"form-control",id:"due_date"},null,8,le),[[b,t.form.due_date]]),i[34]||(i[34]=e("label",{for:"due_date"},"Дата задания",-1))]),((a=t.user)==null?void 0:a.role)>=3?(r(),l(f,{key:5},[i[36]||(i[36]=e("p",{class:"alert alert-info mb-2"},"Назначение ответственного по данной задаче",-1)),e("div",de,[e("div",me,[e("input",{type:"text",class:"form-control",id:"agent",value:t.agentName,placeholder:"Младший администратор",readonly:""},null,8,ue),i[35]||(i[35]=e("label",{for:"agent"},"Администратор",-1))]),e("button",{type:"button",class:"btn btn-outline-light text-primary find-btn",onClick:i[13]||(i[13]=n=>t.tab="agent")},"Выбрать ")])],64)):p("",!0),e("button",{disabled:t.spent_time>0,type:"submit",class:"btn btn-primary w-100 p-3"},[t.spent_time>0?(r(),l("span",ce,h(t.spent_time)+" сек.",1)):(r(),l("span",fe,h(t.isEdit?"Сохранить изменения":"Создать задание"),1))],8,pe)],64)):p("",!0),t.tab==="agent"?(r(),l(f,{key:1},[e("button",{onClick:i[14]||(i[14]=n=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),$(T,{"for-select":!0,onSelect:t.selectAgent},null,8,["onSelect"])],64)):p("",!0),t.tab==="customer"?(r(),l(f,{key:2},[e("button",{onClick:i[15]||(i[15]=n=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),$(V,{"for-select":!0,onSelect:t.selectCustomer},null,8,["onSelect"])],64)):p("",!0),t.tab==="supplier"?(r(),l(f,{key:3},[e("button",{onClick:i[16]||(i[16]=n=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),$(F,{"for-select":!0,onSelect:t.selectSupplier},null,8,["onSelect"])],64)):p("",!0),t.tab==="product"?(r(),l(f,{key:4},[e("button",{onClick:i[17]||(i[17]=n=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),$(q,{"for-select":!0,filters:t.product_filters,onSelect:t.selectProduct},null,8,["filters","onSelect"])],64)):p("",!0)],32)}}});export{ke as _,V as a,Mt as c,P as s,jt as u};
