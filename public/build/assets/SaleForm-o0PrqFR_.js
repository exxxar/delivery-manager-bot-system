import{c as l,o as r,b as e,t as h,i as b,w as p,v as y,h as g,L as C,f as E,a as v,e as f,F as c,r as q,d as k,k as w,J as S,E as V,u as N,H as O}from"./app-GCKBTF7a.js";import{a as D}from"./ReportGenerator-FNgGYsEq.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as B}from"./Pagination-Bg7bRlP4.js";import{m as d}from"./makeAxiosFactory-BdyYrYDn.js";import{_ as P}from"./SupplierList-gJ5TrLap.js";import{a as F,s as j,c as A}from"./ProductList-8fmDkKFl.js";import{u as M}from"./useConfitmModalStore-Cx2KTMxi.js";const L={name:"CustomerCard",props:{customer:{type:Object,required:!0}}},I={class:"container-fluid p-3"},G={class:"card shadow-sm"},z={class:"card-header bg-primary text-white"},J={class:"mb-0"},R={class:"card-body"},H={class:"list-group list-group-flush"},K={class:"list-group-item"},Q={class:"list-group-item"},W={class:"list-group-item"},X={class:"list-group-item"},Y={class:"card-footer text-end"};function Z(o,s,t,i,n,a){return r(),l("div",I,[e("div",G,[e("div",z,[e("h5",J,h(t.customer.name),1)]),e("div",R,[e("ul",H,[e("li",K,[s[2]||(s[2]=e("strong",null,"Компания:",-1)),b(" "+h(t.customer.company_name),1)]),e("li",Q,[s[3]||(s[3]=e("strong",null,"Адрес:",-1)),b(" "+h(t.customer.address),1)]),e("li",W,[s[4]||(s[4]=e("strong",null,"Телефон:",-1)),b(" "+h(t.customer.phone),1)]),e("li",X,[s[5]||(s[5]=e("strong",null,"Email:",-1)),b(" "+h(t.customer.email),1)])])]),e("div",Y,[e("button",{class:"btn btn-outline-secondary me-2",onClick:s[0]||(s[0]=m=>o.$emit("close"))},"Закрыть"),e("button",{class:"btn btn-primary",onClick:s[1]||(s[1]=m=>o.$emit("edit",t.customer))},"Редактировать")])])])}const x=T(L,[["render",Z]]),tt={name:"CustomerForm",props:{initialData:{type:Object,default:null}},data(){return{form:{name:"",company_name:"",address:"",phone:"",email:""},isEdit:!1}},created(){this.initialData&&(this.form={...this.initialData},this.isEdit=!0)},methods:{async submitForm(){try{this.isEdit?(await C.put(`/api/customers/${this.form.id}`,this.form),alert("Клиент обновлён!")):(await C.post("/api/customers",this.form),alert("Клиент добавлен!")),this.$emit("saved")}catch(o){console.error("Ошибка сохранения клиента:",o)}}}},et={class:"container-fluid p-3"},st={class:"form-floating mb-3"},ot={class:"form-floating mb-3"},it={class:"form-floating mb-3"},at={class:"form-floating mb-3"},nt={class:"form-floating mb-3"},rt={type:"submit",class:"btn btn-primary w-100"};function lt(o,s,t,i,n,a){return r(),l("div",et,[e("form",{onSubmit:s[5]||(s[5]=g((...m)=>a.submitForm&&a.submitForm(...m),["prevent"]))},[e("div",st,[p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=m=>n.form.name=m),type:"text",class:"form-control",id:"name",placeholder:"Имя",required:""},null,512),[[y,n.form.name]]),s[6]||(s[6]=e("label",{for:"name"},"Имя",-1))]),e("div",ot,[p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=m=>n.form.company_name=m),type:"text",class:"form-control",id:"company_name",placeholder:"Компания",required:""},null,512),[[y,n.form.company_name]]),s[7]||(s[7]=e("label",{for:"company_name"},"Компания",-1))]),e("div",it,[p(e("input",{"onUpdate:modelValue":s[2]||(s[2]=m=>n.form.address=m),type:"text",class:"form-control",id:"address",placeholder:"Адрес",required:""},null,512),[[y,n.form.address]]),s[8]||(s[8]=e("label",{for:"address"},"Адрес",-1))]),e("div",at,[p(e("input",{"onUpdate:modelValue":s[3]||(s[3]=m=>n.form.phone=m),type:"tel",class:"form-control",id:"phone",placeholder:"Телефон",required:""},null,512),[[y,n.form.phone]]),s[9]||(s[9]=e("label",{for:"phone"},"Телефон",-1))]),e("div",nt,[p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=m=>n.form.email=m),type:"email",class:"form-control",id:"email",placeholder:"Email",required:""},null,512),[[y,n.form.email]]),s[10]||(s[10]=e("label",{for:"email"},"Email",-1))]),e("button",rt,h(n.isEdit?"Сохранить изменения":"Добавить клиента"),1)],32)])}const dt=T(tt,[["render",lt]]),_="/bot-api/customers",mt=E("customers",{state:()=>({items:[],loading:!1,error:null}),getters:{byId:o=>s=>o.items.find(t=>t.id===s)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{const{data:o}=await d(`${_}`,"GET");this.items=o}catch(o){this.error=(o==null?void 0:o.message)||"Failed to load customers"}finally{this.loading=!1}},async fetchAllByPage(o=1){const{data:s}=await d(`${_}?page=${o}`,"GET");this.items=s.data,this.pagination=s},async fetchByUrl(o){const{data:s}=await d(o,"GET");this.items=s.data,this.pagination=s},async create(o){const{data:s}=await d(_,"POST",o);return this.items.push(s),s},async update(o,s){const{data:t}=await d(_,"PUT",s),i=this.items.findIndex(n=>n.id===o);return i!==-1&&(this.items[i]=t),t},async remove(o){await d(`${_}/${o}`,"DELETE"),this.items=this.items.filter(s=>s.id!==o)}}}),pt={class:"form-floating mb-3"},ut={class:"list-group"},ft=["onClick"],ct={class:"fw-bold"},ht={class:"text-muted"},yt={class:"dropdown"},bt={class:"dropdown-menu dropdown-menu-end"},gt={key:0},_t=["onClick"],vt=["onClick"],wt=["onClick"],$t=["onClick"],Ct={key:0,class:"alert alert-info mt-3"},kt={class:"modal fade",id:"editCustomerModal",tabindex:"-1"},St={class:"modal-dialog modal-lg"},Et={class:"modal-content"},Dt={class:"modal-body"},Tt={class:"modal fade",id:"deleteCustomerModal",tabindex:"-1"},Pt={class:"modal-dialog"},Ft={class:"modal-content"},Ut={class:"modal-body"},qt={class:"modal-footer"},Vt={class:"modal fade",id:"viewCustomerModal",tabindex:"-1"},Nt={class:"modal-dialog"},Ot={class:"modal-content"},Bt={class:"modal-body"},jt={name:"CustomerList",props:["forSelect"],data(){return{search:null,customerStore:mt(),selectedCustomer:null}},computed:{filteredCustomers(){if(!this.search)return this.customerStore.items||[];const o=this.search.toLowerCase();return this.customerStore.items.filter(s=>Object.values(s).some(t=>t?String(t).toLowerCase().includes(o):!1))}},created(){this.fetchData()},methods:{selectCustomer(o){this.forSelect&&this.$emit("select",o)},async fetchData(o=1){await this.customerStore.fetchAllByPage(o)},async fetchDataByUrl(o){await this.customerStore.fetchByUrl(o)},openEdit(o){this.selectedCustomer=o,new bootstrap.Modal(document.getElementById("editCustomerModal")).show()},confirmDelete(o){this.selectedCustomer=o,new bootstrap.Modal(document.getElementById("deleteCustomerModal")).show()},async deleteCustomer(){try{await C.delete(`/api/customers/${this.selectedCustomer.id}`),this.customers=this.customers.filter(o=>o.id!==this.selectedCustomer.id),bootstrap.Modal.getInstance(document.getElementById("deleteCustomerModal")).hide()}catch(o){console.error("Ошибка удаления клиента:",o)}},openView(o){this.selectedCustomer=o,new bootstrap.Modal(document.getElementById("viewCustomerModal")).show()}}},U=Object.assign(jt,{setup(o){return(s,t)=>{var i;return r(),l(c,null,[e("div",pt,[p(e("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=n=>s.search=n),class:"form-control",id:"searchInput",placeholder:"Поиск..."},null,512),[[y,s.search]]),t[2]||(t[2]=e("label",{for:"searchInput"},"Поиск",-1))]),e("ul",ut,[(r(!0),l(c,null,q(s.filteredCustomers,n=>(r(),l("li",{onClick:a=>s.selectCustomer(n),key:n.id,class:"list-group-item d-flex justify-content-between align-items-center"},[e("div",null,[e("div",ct,h(n.name),1),e("small",ht,h(n.company_name),1)]),e("div",yt,[t[3]||(t[3]=e("button",{class:"btn btn-sm",type:"button","data-bs-toggle":"dropdown"},[e("i",{class:"fas fa-bars"})],-1)),e("ul",bt,[o.forSelect?(r(),l("li",gt,[e("a",{class:"dropdown-item",href:"#",onClick:g(a=>s.selectCustomer(n),["prevent"])},"Выбрать клиента",8,_t)])):(r(),l(c,{key:1},[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:g(a=>s.openEdit(n),["prevent"])},"Редактировать",8,vt)]),e("li",null,[e("a",{class:"dropdown-item text-danger",href:"#",onClick:g(a=>s.confirmDelete(n),["prevent"])},"Удалить",8,wt)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:g(a=>s.openView(n),["prevent"])},"Просмотреть",8,$t)])],64))])])],8,ft))),128))]),v(B,{pagination:s.customerStore.pagination,onPageChanged:s.fetchDataByUrl},null,8,["pagination","onPageChanged"]),s.customerStore.items.length===0?(r(),l("div",Ct," Клиентов пока нет. ")):f("",!0),e("div",kt,[e("div",St,[e("div",Et,[t[4]||(t[4]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Редактирование клиента"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Dt,[s.selectedCustomer?(r(),k(dt,{key:0,initialData:s.selectedCustomer,onSaved:s.fetchCustomers},null,8,["initialData","onSaved"])):f("",!0)])])])]),e("div",Tt,[e("div",Pt,[e("div",Ft,[t[8]||(t[8]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title text-danger"},"Удаление клиента"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Ut,[t[5]||(t[5]=b(" Вы уверены, что хотите удалить ",-1)),e("strong",null,h((i=s.selectedCustomer)==null?void 0:i.name),1),t[6]||(t[6]=b("? ",-1))]),e("div",qt,[t[7]||(t[7]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Отмена",-1)),e("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=(...n)=>s.deleteCustomer&&s.deleteCustomer(...n))},"Удалить")])])])]),e("div",Vt,[e("div",Nt,[e("div",Ot,[t[9]||(t[9]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Карточка клиента"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Bt,[s.selectedCustomer?(r(),k(x,{key:0,customer:s.selectedCustomer,onEdit:s.openEdit},null,8,["customer","onEdit"])):f("",!0)])])])])],64)}}}),u="/bot-api/sales",At=E("sales",{state:()=>({items:[],loading:!1,filters:null,progress:0,error:null,sort:{field:"id",direction:"desc"}}),getters:{byId:o=>s=>o.items.find(t=>t.id===s)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{const{data:o}=await d(`${u}`,"GET");this.items=o}catch(o){this.error=(o==null?void 0:o.message)||"Failed to load sales"}finally{this.loading=!1}},async acceptAll(o){await d(`${u}/accept-all`,"POST",{ids:o})},async selfSalesFiltered(o=1,s=30){const t=new URLSearchParams;Object.entries(this.filters).forEach(([n,a])=>{a!=null&&a!==""&&t.append(n,String(a))}),t.append("sort_field",this.sort.field),t.append("sort_direction",this.sort.direction),t.append("page",String(o)),t.append("size",String(s));const{data:i}=await d(`${u}/self-sales?${t.toString()}`,"GET");return this.items=i.data,this.pagination=i,!0},async fetchFiltered(o=1,s=30){const t=new URLSearchParams;Object.entries(this.filters).forEach(([n,a])=>{a!=null&&a!==""&&t.append(n,String(a))}),t.append("sort_field",this.sort.field),t.append("sort_direction",this.sort.direction),t.append("page",String(o)),t.append("size",String(s));const{data:i}=await d(`${u}?${t.toString()}`,"GET");return this.items=i.data,this.pagination=i,!0},setFilters(o){this.filters=o},setSort(o,s){this.sort={field:o,direction:s}},async fetchAllByPage(o=1){const{data:s}=await d(`${u}?page=${o}`,"GET");this.items=s.data,this.pagination=s},async fetchByUrl(o){const{data:s}=await d(o,"GET");this.items=s.data,this.pagination=s},async sendPaymentDocumentToTg(o){try{const{data:s}=await d(`${u}/payment-document/${o}`,"GET");return!0}catch(s){throw this.error=(s==null?void 0:s.message)||"Failed to load sale",s}},async fetchOne(o){try{const{data:s}=await d(`${u}/${o}`,"GET");return s}catch(s){throw this.error=(s==null?void 0:s.message)||"Failed to load sale",s}},async create(o,s){const t=new FormData;Object.keys(o).forEach(n=>{const a=o[n]||"";typeof a=="object"?t.append(n,JSON.stringify(a)):t.append(n,a)}),s&&t.append("file",s);const{data:i}=await d(`${u}`,"POST",t,{headers:{"Content-Type":"multipart/form-data"}});return this.items.push(i),i},async update(o,s,t){const i=new FormData;Object.keys(s).forEach(m=>{const $=s[m]||"";typeof $=="object"?i.append(m,JSON.stringify($)):i.append(m,$)}),t&&i.append("file",t);const{data:n}=await d(`${u}/${o}`,"POST",i,{headers:{"Content-Type":"multipart/form-data"}}),a=this.items.findIndex(m=>m.id===o);return a!==-1&&(this.items[a]=n),n},async confirmDealAndPayment(o){var s;try{const t=new FormData;t.append("id",o.id||null),t.append("payment_type",o.payment_type||0),t.append("sale_date",o.sale_date||""),t.append("actual_delivery_date",o.actual_delivery_date||""),t.append("quantity",o.quantity||1),t.append("total_price",o.total_price),t.append("receipt_is_lost",o.receipt_is_lost||!1),t.append("same_sale_delivery_date",o.same_sale_delivery_date||!1),t.append("additional_comment",o.additional_comment||""),t.append("need_additional_comment",o.need_additional_comment||!1),t.append("status","completed"),this.progress=0,(o.files||[]).length>0&&o.files.forEach((n,a)=>{t.append(`files[${a}]`,n)});const{data:i}=await d(`${u}/confirm-deal-payment`,"POST",t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:n=>{n.total&&(this.progress=Math.round(n.loaded*100/n.total))}});return await this.fetchAllByPage(((s=this.pagination)==null?void 0:s.current_page)||1),i}catch(t){throw t}},async confirmPayment(o){var s;try{const t=new FormData;t.append("id",o.id||null),t.append("payment_type",o.payment_type||0),t.append("receipt_is_lost",o.receipt_is_lost||!1),o.file&&t.append("file",o.file);const{data:i}=await d(`${u}/confirm-payment`,"POST",t,{headers:{"Content-Type":"multipart/form-data"}});return await this.fetchAllByPage(((s=this.pagination)==null?void 0:s.current_page)||1),i}catch(t){throw t}},async confirmDeal(o){var s;try{const{data:t}=await d(`${u}/confirm-deal`,"POST",{...o,status:"completed"});return await this.fetchAllByPage(((s=this.pagination)==null?void 0:s.current_page)||1),t}catch(t){throw console.error("Ошибка подтверждения сделки:",t),t}},async deleteSale(o){try{return await d(`${u}/${o}`,"DELETE"),this.items=this.items.filter(s=>s.id!==o),!0}catch(s){throw console.error("Ошибка удаления продажи:",s),s}},async cancelDeal(o){var s;try{const{data:t}=await d(`${u}/${o.id}`,"PUT",{...o,status:"rejected"});return await this.fetchAllByPage(((s=this.pagination)==null?void 0:s.current_page)||1),t}catch(t){throw console.error("Ошибка отмены сделки:",t),t}}}}),Mt={class:"form-check form-switch mb-2"},Lt={class:"form-check-label",for:"need_automatic_naming"},It={key:0,class:"fw-bold text-primary"},Gt={key:1,class:"fw-bold text-primary"},zt={class:"form-floating mb-2"},Jt={class:"form-floating mb-2"},Rt={class:"input-group mb-2"},Ht={class:"form-floating flex-grow-1"},Kt=["value"],Qt={class:"input-group mb-2"},Wt={class:"form-floating flex-grow-1"},Xt=["value"],Yt=["disabled"],Zt={class:"form-floating mb-2"},xt={class:"form-floating mb-2"},te={class:"form-floating mb-2"},ee={class:"form-floating mb-2"},se=["required"],oe={class:"form-check form-switch mb-2"},ie={key:3,class:"form-floating mb-2"},ae={class:"form-check form-switch mb-2"},ne={class:"form-floating mb-2"},re=["min"],le={class:"input-group mb-2"},de={class:"form-floating flex-grow-1"},me=["value"],pe={key:5,class:"form-check form-switch mb-2"},ue=["disabled"],fe={key:0},ce={key:1},he={name:"SaleForm",components:{AgentList:D,CustomerList:U,SupplierListGroup:P,ProductList:F},props:{initialData:{type:Object,default:null}},watch:{"form.quantity":function(o,s){this.form.total_price===0&&(this.form.total_price=(this.product.price*this.form.quantity).toFixed(2))}},computed:{user(){return this.userStore.self||null},productName(){var o;return((o=this.product)==null?void 0:o.name)||""}},data(){return{tab:"main",spent_time:0,alertStore:O(),salesStore:At(),userStore:M(),can_add_past_assignments:!1,file:null,product_filters:{supplier_id:null},form:{title:"",description:"",status:"pending",due_date:"",sale_date:"",quantity:0,total_price:0,agent_id:null,customer_id:null,supplier_id:null,product_id:null,payment_type:"0",payment_document_name:null,need_automatic_naming:!0,receipt_is_lost:!1,is_already_delivered:!1},agentName:"",customerName:"",supplierName:"",product:null,isEdit:!1}},created(){var o,s,t;this.initialData&&(this.form={...this.initialData},this.form.need_automatic_naming=!0,this.form.payment_type=""+this.form.payment_type,this.isEdit=!0,this.agentName=((o=this.initialData.agent)==null?void 0:o.name)||"",this.customerName=((s=this.initialData.customer)==null?void 0:s.name)||"",this.supplierName=((t=this.initialData.supplier)==null?void 0:t.name)||"",this.product=this.initialData.product||null)},mounted(){A(),window.addEventListener("trigger-spent-timer",o=>{this.spent_time=o.detail})},methods:{onFileChange(o){this.file=o.target.files[0]},selectAgent(o){this.form.agent_id=o.id,this.agentName=o.name,this.tab="main"},selectCustomer(o){this.form.customer_id=o.id,this.customerName=o.name,this.tab="main"},selectSupplier(o){const s=this.form.supplier_id;this.form.supplier_id=null,this.supplierName=null,this.product_filters.supplier_id=null,s!==o.id&&(this.form.product_id=null,this.product=null),this.$nextTick(()=>{this.form.supplier_id=o.id,this.supplierName=o.name,this.tab="main",this.product_filters.supplier_id=o.id})},selectProduct(o){this.form.product_id=o.id,this.product=o,this.tab="main",this.form.quantity=1,this.form.total_price=o.price||0},async submitForm(){this.alertStore.show("Началось добавление заявки"),j(10),this.isEdit?await this.salesStore.update(this.form.id,this.form,this.file):await this.salesStore.create(this.form,this.file),this.$emit("saved")}}},ke=Object.assign(he,{setup(o){const s=new Date().toISOString().split("T")[0];return(t,i)=>{var n;return r(),l("form",{onSubmit:i[19]||(i[19]=g((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[t.tab==="main"?(r(),l(c,{key:0},[e("div",Mt,[p(e("input",{"onUpdate:modelValue":i[0]||(i[0]=a=>t.form.need_automatic_naming=a),class:"form-check-input",type:"checkbox",role:"switch",id:"need_automatic_naming"},null,512),[[w,t.form.need_automatic_naming]]),e("label",Lt,[i[20]||(i[20]=b("Автоматическое название и описание ",-1)),t.form.need_automatic_naming?(r(),l("span",It,"включено")):(r(),l("span",Gt,"выключено"))])]),t.form.need_automatic_naming?f("",!0):(r(),l(c,{key:0},[e("div",zt,[p(e("input",{"onUpdate:modelValue":i[1]||(i[1]=a=>t.form.title=a),type:"text",class:"form-control",id:"title",placeholder:"Название",required:""},null,512),[[y,t.form.title]]),i[21]||(i[21]=e("label",{for:"title"},"Название задания",-1))]),e("div",Jt,[p(e("textarea",{"onUpdate:modelValue":i[2]||(i[2]=a=>t.form.description=a),class:"form-control",id:"description",placeholder:"Описание",style:{height:"120px"},required:""},null,512),[[y,t.form.description]]),i[22]||(i[22]=e("label",{for:"description"},"Описание задания",-1))])],64)),e("div",Rt,[e("div",Ht,[e("input",{required:"",type:"text",class:"form-control",id:"supplier",value:t.supplierName,placeholder:"Поставщик",readonly:""},null,8,Kt),i[23]||(i[23]=e("label",{for:"supplier"},"Поставщик",-1))]),e("button",{type:"button",class:"btn btn-outline-light text-primary find-btn",onClick:i[3]||(i[3]=a=>t.tab="supplier")}," Выбрать ")]),e("div",Qt,[e("div",Wt,[e("input",{type:"text",required:"",class:"form-control",id:"product",value:t.productName,placeholder:"Продукт",readonly:""},null,8,Xt),i[24]||(i[24]=e("label",{for:"product"},"Продукт",-1))]),e("button",{type:"button",disabled:t.form.supplier_id==null,class:"btn btn-outline-light text-primary find-btn",onClick:i[4]||(i[4]=a=>t.tab="product")},"Выбрать ",8,Yt)]),t.form.supplier_id&&t.form.product_id?(r(),l(c,{key:1},[e("div",Zt,[p(e("input",{required:"","onUpdate:modelValue":i[5]||(i[5]=a=>t.form.quantity=a),type:"number",class:"form-control",id:"quantity",placeholder:"Количество"},null,512),[[y,t.form.quantity]]),i[25]||(i[25]=e("label",{for:"quantity"},"Количество",-1))]),e("div",xt,[p(e("input",{"onUpdate:modelValue":i[6]||(i[6]=a=>t.form.total_price=a),required:"",type:"number",step:"0.01",class:"form-control",id:"total_price",placeholder:"Сумма"},null,512),[[y,t.form.total_price]]),i[26]||(i[26]=e("label",{for:"total_price"},"Сумма сделки",-1))])],64)):f("",!0),e("div",te,[p(e("select",{class:"form-select","onUpdate:modelValue":i[7]||(i[7]=a=>t.form.payment_type=a),id:"payment-type","aria-label":"Floating label select example"},[...i[27]||(i[27]=[e("option",{value:"0"},"Наличный расчет",-1),e("option",{value:"1"},"Безналичный расчет",-1)])],512),[[S,t.form.payment_type]]),i[28]||(i[28]=e("label",{for:"payment-type"},"Тип оплаты",-1))]),t.form.payment_type==="1"?(r(),l(c,{key:2},[i[31]||(i[31]=e("h6",null,"Фотография чека",-1)),e("div",ee,[e("input",{type:"file",class:"form-control",onChange:i[8]||(i[8]=(...a)=>t.onFileChange&&t.onFileChange(...a)),accept:".jpg,.png,.pdf",required:!t.form.receipt_is_lost},null,40,se),i[29]||(i[29]=e("label",{for:"payment-type"},"Прикрепить",-1))]),e("div",oe,[p(e("input",{"onUpdate:modelValue":i[9]||(i[9]=a=>t.form.receipt_is_lost=a),class:"form-check-input",type:"checkbox",role:"switch",id:"need_automatic_naming"},null,512),[[w,t.form.receipt_is_lost]]),i[30]||(i[30]=e("label",{class:"form-check-label",for:"need_automatic_naming"},"Чек был утрачен ",-1))])],64)):f("",!0),t.isEdit?(r(),l("div",ie,[p(e("select",{"onUpdate:modelValue":i[10]||(i[10]=a=>t.form.status=a),class:"form-select",id:"status",required:""},[...i[32]||(i[32]=[V('<option value="pending">Ожидает</option><option value="assigned">Назначено</option><option value="delivered">Доставляется</option><option value="completed">Завершено</option><option value="rejected">Отклонено</option>',5)])],512),[[S,t.form.status]]),i[33]||(i[33]=e("label",{for:"status"},"Статус",-1))])):f("",!0),e("div",ae,[p(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":i[11]||(i[11]=a=>t.can_add_past_assignments=a),id:"can-add-past-tasks"},null,512),[[w,t.can_add_past_assignments]]),i[34]||(i[34]=e("label",{class:"form-check-label",for:"can-add-past-tasks"}," Разрешить вносить за прошедшие дни ",-1))]),e("div",ne,[p(e("input",{"onUpdate:modelValue":i[12]||(i[12]=a=>t.form.due_date=a),required:"",min:t.can_add_past_assignments?null:N(s),type:"date",class:"form-control",id:"due_date"},null,8,re),[[y,t.form.due_date]]),i[35]||(i[35]=e("label",{for:"due_date"},"Дата задания",-1))]),((n=t.user)==null?void 0:n.role)>=3?(r(),l(c,{key:4},[i[37]||(i[37]=e("p",{class:"alert alert-info mb-2"},"Назначение ответственного по данной задаче",-1)),e("div",le,[e("div",de,[e("input",{type:"text",class:"form-control",id:"agent",value:t.agentName,placeholder:"Младший администратор",readonly:""},null,8,me),i[36]||(i[36]=e("label",{for:"agent"},"Администратор",-1))]),e("button",{type:"button",class:"btn btn-outline-light text-primary find-btn",onClick:i[13]||(i[13]=a=>t.tab="agent")}," Выбрать ")])],64)):f("",!0),t.isEdit?f("",!0):(r(),l("div",pe,[p(e("input",{"onUpdate:modelValue":i[14]||(i[14]=a=>t.form.is_already_delivered=a),class:"form-check-input",type:"checkbox",role:"switch",id:"is_already_delivered"},null,512),[[w,t.form.is_already_delivered]]),i[38]||(i[38]=e("label",{class:"form-check-label",for:"is_already_delivered"},"Товар уже доставлен ",-1))])),e("button",{disabled:t.spent_time>0,type:"submit",class:"btn btn-primary w-100 p-3"},[t.spent_time>0?(r(),l("span",fe,h(t.spent_time)+" сек.",1)):(r(),l("span",ce,h(t.isEdit?"Сохранить изменения":"Создать задание"),1))],8,ue)],64)):f("",!0),t.tab==="agent"?(r(),l(c,{key:1},[e("button",{onClick:i[15]||(i[15]=a=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),v(D,{"for-select":!0,onSelect:t.selectAgent},null,8,["onSelect"])],64)):f("",!0),t.tab==="customer"?(r(),l(c,{key:2},[e("button",{onClick:i[16]||(i[16]=a=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),v(U,{"for-select":!0,onSelect:t.selectCustomer},null,8,["onSelect"])],64)):f("",!0),t.tab==="supplier"?(r(),l(c,{key:3},[e("button",{onClick:i[17]||(i[17]=a=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),v(P,{"for-select":!0,onSelect:t.selectSupplier},null,8,["onSelect"])],64)):f("",!0),t.tab==="product"?(r(),l(c,{key:4},[e("button",{onClick:i[18]||(i[18]=a=>t.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"0px","z-index":"100"}},"Назад "),v(F,{"for-select":!0,filters:t.product_filters,onSelect:t.selectProduct},null,8,["filters","onSelect"])],64)):f("",!0)],32)}}});export{ke as _,U as a,At as u};
